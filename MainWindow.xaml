<Window x:Class="PCL_CE_Patcher.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="PCL CE Patcher" Height="250" Width="500"
        ResizeMode="NoResize" WindowStartupLocation="CenterScreen"
        AllowDrop="True" Drop="Window_Drop">
    <!-- Window_Drop 处理整个窗口的拖放 -->

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" Text="PCL Community Edition Patcher" 
                   FontSize="18" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,0,0,20"/>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="80"/>
            </Grid.ColumnDefinitions>

            <!-- 关键修改：添加 PreviewDragOver -->
            <TextBox x:Name="TxtPath" Grid.Column="0" Height="30" VerticalContentAlignment="Center" 
                     Text="请选择或直接拖入文件..." Foreground="Gray"
                     IsReadOnly="True"
                     PreviewDragOver="TxtPath_PreviewDragOver" 
                     Drop="Window_Drop"/>
            <!-- TextBox 也复用 Window 的 Drop 处理逻辑 -->

            <Button x:Name="BtnBrowse" Grid.Column="1" Content="浏览" Margin="10,0,0,0" 
                    Click="BtnBrowse_Click"/>
        </Grid>

        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,15,0,0">
            <TextBlock Text="PCL2_CE版本：" VerticalAlignment="Center" Margin="0,0,10,0"/>
            <ComboBox x:Name="CboVersion" Width="150" SelectedIndex="0" VerticalContentAlignment="Center">
                <ComboBoxItem Content="2.14.0-beta.x"/>
            </ComboBox>
        </StackPanel>

        <TextBlock x:Name="LblStatus" Grid.Row="3" Text="准备就绪" 
                   Foreground="Gray" VerticalAlignment="Center" HorizontalAlignment="Center"/>

        <Grid Grid.Row="4">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Button x:Name="BtnPatch" Grid.Column="0" Content="开始修补" Height="40" Margin="0,0,10,0" 
                    IsEnabled="False" Click="BtnPatch_Click" FontWeight="Bold"/>

            <Button x:Name="BtnExit" Grid.Column="1" Content="退出" Height="40" Margin="10,0,0,0" 
                    Click="BtnExit_Click"/>
        </Grid>
    </Grid>
</Window>